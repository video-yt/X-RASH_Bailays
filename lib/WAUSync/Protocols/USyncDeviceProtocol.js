Object.defineProperty(exports,"__esModule",{value:!0});exports.USyncDeviceProtocol=void 0;const WABinary_1=require("../../WABinary");
class USyncDeviceProtocol{constructor(){this.name="devices"}getQueryElement(){return{tag:"devices",attrs:{version:"2"}}}getUserElement(){return null}parser(a){const d=[];let e=void 0;if("devices"===a.tag){(0,WABinary_1.assertNodeErrorFree)(a);var b=(0,WABinary_1.getBinaryNodeChild)(a,"device-list");a=(0,WABinary_1.getBinaryNodeChild)(a,"key-index-list");if(Array.isArray(null===b||void 0===b?void 0:b.content))for(const {tag:f,attrs:c}of b.content){b=+c.id;const g=+c["key-index"];"device"===f&&d.push({id:b,
keyIndex:g,isHosted:!(!c.is_hosted||"true"!==c.is_hosted)})}"key-index-list"===(null===a||void 0===a?void 0:a.tag)&&(e={timestamp:+a.attrs.ts,signedKeyIndex:null===a||void 0===a?void 0:a.content,expectedTimestamp:a.attrs.expected_ts?+a.attrs.expected_ts:void 0})}return{deviceList:d,keyIndex:e}}}exports.USyncDeviceProtocol=USyncDeviceProtocol;
